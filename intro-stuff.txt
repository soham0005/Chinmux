import subprocess
import webbrowser
import spacy

# Load the English NLP model
nlp = spacy.load("en_core_web_sm")

def process_command(command):
    doc = nlp(command)
    
    # Detect intent (you'll need to expand this)
    if "install" in command:
        package = [token.text for token in doc if token.dep_ == "dobj"][0]
        install_package(package)
    elif "open" in command:
        app = [token.text for token in doc if token.dep_ == "dobj"][0]
        open_application(app)
    elif "send mail" in command or "send email" in command:
        recipient = [token.text for token in doc if token.dep_ == "pobj"][-1]
        send_email(recipient)
    else:
        print("I'm not sure how to help with that. Can you please rephrase?")

def install_package(package):
    confirm = input(f"Do you want to install {package}? (y/n): ")
    if confirm.lower() == 'y':
        subprocess.run(["sudo", "apt", "install", package])
    else:
        print("Installation cancelled.")

def open_application(app):
    confirm = input(f"Do you want to open {app}? (y/n): ")
    if confirm.lower() == 'y':
        subprocess.Popen(app)
    else:
        print("Application launch cancelled.")

def send_email(recipient):
    webbrowser.open(f"mailto:{recipient}")

def main():
    while True:
        user_input = input("How can I help you? ")
        if user_input.lower() == 'exit':
            break
        process_command(user_input)

if __name__ == "__main__":
    main()
